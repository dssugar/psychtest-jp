/**
 * Industriousness / Grit (IPIP-300 C4+C5) - Scoring & Configuration
 *
 * 勤勉性 / やり抜く力の採点と象限判定
 *
 * サブスケール:
 * - C4: Achievement Striving (達成動機) - 10-50点
 * - C5: Self-Discipline (自己鍛錬) - 10-50点
 * - 合計: 20-100点
 *
 * 象限タイプ (2×2 matrix):
 * - 実行者型 (Achiever): High C4, High C5
 * - 構想家型 (Visionary): High C4, Low C5
 * - 着実型 (Steady): Low C4, High C5
 * - マイペース型 (Relaxed): Low C4, Low C5
 *
 * @reference DeYoung, C. G., Quilty, L. C., & Peterson, J. B. (2007). Between
 *            facets and domains: 10 aspects of the Big Five. Journal of Personality
 *            and Social Psychology, 93(5), 880-896.
 */

import {
  industriousnessQuestions,
  scaleOptions,
  scaleInfo,
} from "@/data/industriousness-questions";
import type { TestConfig } from "./types";
import type { DimensionData } from "@/lib/og-design/types";

// ============================================================================
// Constants
// ============================================================================

// 🆕 Industriousness次元の色定義（定数化）
const INDUSTRIOUSNESS_COLORS = {
  c4: '#3b82f6', // 青 - Achievement Striving (達成動機)
  c5: '#10b981', // 緑 - Self-Discipline (自己統制)
} as const;

// ============================================================================
// Types & Interfaces
// ============================================================================

/**
 * 勤勉性の象限タイプ
 */
export type IndustriousnessQuadrant =
  | "achiever" // 実行者型 (High C4, High C5)
  | "visionary" // 構想家型 (High C4, Low C5)
  | "steady" // 着実型 (Low C4, High C5)
  | "relaxed"; // マイペース型 (Low C4, Low C5)

/**
 * 詳細解釈の型（Rosenbergと同じ構造）
 */
export interface DetailedInterpretation {
  summary: string;
  dailyLifeImpact: string;
  psychBackground: string;
  practicalAdvice: string;
}

/**
 * 勤勉性の結果型
 */
export interface IndustriousnessResult {
  // サブスケールスコア (10-50 each)
  c4_achievement: number; // 達成動機
  c5_discipline: number; // 自己鍛錬

  // 合計スコア (20-100)
  rawScore: number;

  // パーセンタイル (0-100%)
  c4_percentile: number;
  c5_percentile: number;

  // 象限タイプ
  quadrant: IndustriousnessQuadrant;
  quadrantLabel: string; // e.g., "実行者型"

  // NOTE: interpretation は保存せず、表示時に getDetailedInterpretation() で動的生成
}

// ============================================================================
// Scoring Logic
// ============================================================================

/**
 * 勤勉性スコア計算
 * @param answers 各質問への回答（1-5）
 * @returns 計算結果
 */
export function calculateIndustriousnessScore(
  answers: number[]
): IndustriousnessResult {
  if (answers.length !== 20) {
    throw new Error("回答数が正しくありません。20問の回答が必要です。");
  }

  // スコア初期化
  let c4_achievement = 0;
  let c5_discipline = 0;

  // スコア計算（逆転項目を考慮）
  for (let i = 0; i < answers.length; i++) {
    const answer = answers[i];
    const question = industriousnessQuestions[i];

    if (answer < 1 || answer > 5) {
      throw new Error(
        `無効な回答値: ${answer}. 1-5の範囲で回答してください。`
      );
    }

    // 逆転項目の場合は反転（1→5, 2→4, 3→3, 4→2, 5→1）
    const score = question.reverse ? 6 - answer : answer;

    // サブスケールごとに加算
    if (question.subscale === "c4_achievement") {
      c4_achievement += score;
    } else if (question.subscale === "c5_discipline") {
      c5_discipline += score;
    }
  }

  // 合計スコア
  const rawScore = c4_achievement + c5_discipline;

  // パーセンタイル計算 ((rawScore - min) / (max - min)) * 100
  const c4_percentile = ((c4_achievement - 10) / 40) * 100;
  const c5_percentile = ((c5_discipline - 10) / 40) * 100;

  // 象限判定（50%を閾値とする）
  const c4_high = c4_percentile >= 50;
  const c5_high = c5_percentile >= 50;

  let quadrant: IndustriousnessQuadrant;
  let quadrantLabel: string;

  if (c4_high && c5_high) {
    quadrant = "achiever";
    quadrantLabel = "実行者型";
  } else if (c4_high && !c5_high) {
    quadrant = "visionary";
    quadrantLabel = "構想家型";
  } else if (!c4_high && c5_high) {
    quadrant = "steady";
    quadrantLabel = "着実型";
  } else {
    quadrant = "relaxed";
    quadrantLabel = "マイペース型";
  }

  return {
    c4_achievement,
    c5_discipline,
    rawScore,
    c4_percentile,
    c5_percentile,
    quadrant,
    quadrantLabel,
  };
}

/**
 * 象限に基づく解釈を返す
 * 表示時に動的生成するため、localStorage に保存しない
 */
export function getInterpretation(
  quadrant: IndustriousnessQuadrant,
  c4_percentile: number,
  c5_percentile: number
): string {
  const c4_label = getPercentileLabel(c4_percentile);
  const c5_label = getPercentileLabel(c5_percentile);

  switch (quadrant) {
    case "achiever":
      return `## 実行者型（達成動機: 高、自己鍛錬: 高）

### あなたの特徴

あなたは**実行者型**です（達成動機: ${c4_label}、自己鍛錬: ${c5_label}）。

高い目標を設定し、それを着実に実行に移す力を兼ね備えています。野心と自己統制のバランスが取れており、長期的な目標に向かって計画的に努力を続けられます。学業や仕事において高いパフォーマンスを発揮しやすく、「言ったことを必ずやる人」として周囲から信頼されているでしょう。この特性は、誠実性（Conscientiousness）の中でも特に成功と強く結びついた組み合わせです。

### 日常生活への影響

**仕事・学業**
プロジェクトの遂行能力が非常に高く、締め切りを守りながら質の高い成果を出せます。目標設定が明確で、そこに向かう具体的な行動計画を立てて実行できるため、上司や教師から高く評価されることが多いでしょう。昇進や成績上位者に選ばれやすく、リーダーシップを発揮する場面も多いはずです。ただし、過度な完璧主義や長時間労働に陥りやすく、燃え尽き症候群（バーンアウト）のリスクも抱えています。

**対人関係**
約束を守る信頼できる人として評価される一方で、他人にも同じ基準を求めてしまい、「厳しい」「融通が利かない」と感じられることがあります。特に達成動機の高さから、チームメンバーにも高いパフォーマンスを期待し、それが達成されないとストレスを感じやすいでしょう。意識的にリラックスした交流を持つことが、人間関係の質を高めます。

**意思決定**
合理的で計画的な意思決定ができます。目標達成に必要な選択肢を冷静に評価し、実行可能性の高い道を選びます。ただし、完璧を求めすぎて決断が遅れたり、「今すぐやる」ことに固執して柔軟性を失うこともあるため、状況に応じた調整が必要です。

**余暇・プライベート**
趣味やプライベートでも目標を設定しがちで、「リラックスする」ことが苦手な傾向があります。休暇中も何かを達成しようとしてしまい、本当の休息が取れないことがあります。意識的に「何も生産しない時間」を作ることが、長期的なパフォーマンス維持に重要です。

### 心理学的背景

研究によると、達成動機と自己鍛錬の両方が高い人は、学業成績（GPA）、職業的成功、収入の高さと強く相関します（Roberts et al., 2005）。この組み合わせは、誠実性（Conscientiousness）の中核的要素であり、Big Fiveの中で**最も仕事のパフォーマンスを予測する特性**として知られています（メタ分析: r = 0.22-0.31）。

神経科学的には、前頭前皮質の活動と関連しており、目標志向的な行動制御、衝動の抑制、長期的報酬の優先が可能になります。遺伝的要因も大きく（遺伝率 約40-50%）、幼少期からの安定した特性として現れます。

ただし、過度に高い場合は**ワーカホリズム**（仕事依存症）や強迫的な完璧主義と重なることがあり、メンタルヘルスのリスクも認識する必要があります。

### 実用的アドバイス

**強みを活かす**
1. **長期プロジェクトのリード**: あなたの計画性と実行力を活かし、数ヶ月〜数年単位のプロジェクトで中心的役割を担いましょう
2. **目標管理システムの構築**: 自分の強みを体系化し、GTD（Getting Things Done）やOKR（Objectives and Key Results）などのフレームワークを導入すると、さらに効率が上がります
3. **メンターシップ**: 後輩や同僚に目標達成の方法を教えることで、組織全体のパフォーマンスが向上します

**バランスを取る（重要）**
1. **意図的な休息**: 週に1日は「何も達成しない日」を作る。スケジュールに「リラックス時間」を明示的に組み込む
2. **完璧主義の緩和**: 「80%の完成度で十分」という基準を持つ。全てを100%にする必要はありません
3. **柔軟性の訓練**: 計画通りにいかないことを受け入れる練習。予定外の出来事を楽しむ余裕を持つ

**注意すべきリスク**
1. **バーンアウト**: 高い基準を維持し続けると燃え尽きます。疲労のサインを見逃さない
2. **対人関係の摩擦**: 他人に同じ基準を求めない。多様な働き方を尊重する
3. **ワークライフバランス**: 仕事の成功が人生の全てではありません。家族、友人、健康への投資も重要です

**自己モニタリング**
- 週に1回、「今週は楽しめたか？」を自問する
- 睡眠時間が6時間を下回る週が続いたら危険信号
- 「休むことへの罪悪感」が強い場合は、カウンセリングも検討`;

    case "visionary":
      return `## 構想家型（達成動機: 高、自己鍛錬: 低）

### あなたの特徴

あなたは**構想家型**です（達成動機: ${c4_label}、自己鍛錬: ${c5_label}）。

大きな目標やビジョンを持ち、野心的な計画を立てることが得意です。しかし、それを具体的な行動に移したり、日々のタスクを着実にこなすことには課題を感じやすい傾向があります。「思い立ったらすぐ行動」するタイプではありますが、継続的な努力が必要な局面では先延ばしにしがちです。潜在能力は高いものの、実行段階で苦労することが多いでしょう。

### 日常生活への影響

**仕事・学業**
新しいプロジェクトのアイデア出しや戦略立案は得意ですが、細かいタスクの実行や締め切り管理に苦労します。「やりたいこと」はたくさんあるのに、実際に完成させるプロジェクトは少ないかもしれません。スタートダッシュは良いものの、中盤で失速したり、締め切り直前に慌てて仕上げるパターンが多いでしょう。上司からは「もっと計画的に」「もっと地道に」と言われることがあるかもしれません。

**対人関係**
理想や目標について熱く語ることができ、周囲を鼓舞する力があります。しかし、約束を守れなかったり、「言うだけで行動が伴わない」と見られることがあり、信頼を損なうリスクがあります。特にチームワークが求められる場面で、自分のタスクを完了させられないと、他メンバーに迷惑をかけてしまいます。

**意思決定**
大きな方向性の決定は得意ですが、具体的な実行計画や細部の詰めが甘くなりがちです。「こうなったらいいな」という理想は描けても、「どうやって実現するか」の具体策が不足します。また、衝動的な決断をしてしまい、後から「やっぱり無理だった」となることもあります。

**余暇・プライベート**
多趣味で興味の幅が広く、新しいことに挑戦するのが好きです。ただし、どれも中途半端で終わってしまい、「続かない人」という自己評価を持ちがちです。ジムに入会しても続かない、資格勉強を始めても途中で挫折する、といったパターンが繰り返されることがあります。

### 心理学的背景

この組み合わせは、**達成動機は高いが実行機能（Executive Function）が弱い**状態を示しています。前頭前皮質の目標設定回路は活発ですが、行動開始や持続を司る部分の機能が相対的に低い可能性があります。

研究では、達成動機だけが高く自己鍛錬が低い場合、目標達成率は平均的かそれ以下になることが示されています（Duckworth et al., 2007）。**「やる気はあるのに行動できない」**というギャップは、ADHD（注意欠如・多動症）の傾向とも関連することがあります（ただし診断ではありません）。

興味深いことに、このタイプは**起業家やクリエイター**に多く見られ、アイデアの豊富さや柔軟性という強みも持っています。ただし、持続的成功のためには、実行をサポートする仕組みやパートナーが必要です。

### 実用的アドバイス

**実行力を補う仕組み作り**
1. **外部構造の活用**: 締め切りを他人に宣言する、アカウンタビリティ・パートナーを持つ、コーチングを受けるなど、外部からのプレッシャーを活用
2. **タスク分解**: 大きな目標を「今日できる15分のタスク」まで分解する。小さな一歩から始める
3. **環境設計**: 誘惑を排除し、作業環境を整える。スマホを別室に置く、作業専用スペースを作るなど

**強みを活かす場面**
1. **アイデア出しの役割**: ブレインストーミング、戦略立案、ビジョン策定など、構想段階で力を発揮
2. **パートナーシップ**: 実行力の高い人とチームを組む。あなたが「何を」を決め、相手が「どうやって」を担当
3. **短期集中型の仕事**: 長期プロジェクトより、短期で完結するタスクの方が成功しやすい

**自己鍛錬の育成（段階的に）**
1. **習慣化アプローチ**: 「毎日5分」など、極めて小さな習慣から始める（Tiny Habits / BJ Fogg）
2. **if-thenプランニング**: 「もし〇〇したら、すぐに△△する」という具体的なトリガーを設定
3. **進捗の可視化**: チェックリスト、進捗バー、カレンダーなどで「やった感」を視覚化

**専門家の支援も検討**
- 慢性的に「やりたいのにできない」が続く場合、ADHD評価を専門医に相談するのも一案
- コーチングやカウンセリングで、行動変容の支援を受ける
- 「自分はダメ」と責めず、「仕組みで解決できる」という視点を持つ`;

    case "steady":
      return `## 着実型（達成動機: 低、自己鍛錬: 高）

### あなたの特徴

あなたは**着実型**です（達成動機: ${c4_label}、自己鍛錬: ${c5_label}）。

高い目標を掲げることよりも、日々の仕事を確実にこなすことを重視します。計画的で規律正しく、与えられたタスクを着実に完了させる力があります。野心的なキャリアアップよりも、安定した生活や着実な成長を好む傾向があります。「地に足がついている」「信頼できる」と評価されることが多く、組織の縁の下の力持ちとして重要な役割を果たしています。

### 日常生活への影響

**仕事・学業**
ルーチンワークや決められたタスクの遂行能力が高く、ミスが少なく期限を守ります。上司から指示されたことは確実にこなし、「安心して任せられる人」として信頼されます。ただし、自ら新しいプロジェクトを立ち上げたり、昇進のために積極的にアピールしたりすることは少ないでしょう。現状維持を好み、リスクを取った挑戦には消極的です。そのため、能力があってもキャリアの伸びが緩やかになることがあります。

**対人関係**
穏やかで協調的、チームの安定性に貢献します。派手さはありませんが、地道に人間関係を築き、長期的な信頼を得られます。他人に高い要求をせず、それぞれのペースを尊重するため、一緒にいて楽な存在です。ただし、リーダーシップを発揮する場面では物足りなさを感じられることもあります。

**意思決定**
リスクを避け、安全で確実な選択肢を選びます。「現状を維持する」という選択が多く、大きな変化を避ける傾向があります。これは安定性をもたらしますが、新しいチャンスを逃したり、変化が必要な時に対応が遅れることもあります。

**余暇・プライベート**
ルーティンを好み、規則正しい生活を送ります。毎週同じ曜日に同じことをする、といった習慣を持ちやすく、それが安心感につながります。新しい趣味や旅行よりも、慣れ親しんだ活動を楽しむ傾向があります。

### 心理学的背景

このタイプは、**実行機能は高いが動機づけシステムが控えめ**という特徴があります。神経科学的には、前頭前皮質の行動制御は機能していますが、報酬系（腹側線条体、側坐核）の活動が比較的低い可能性があります。

研究では、自己鍛錬が高いが達成動機が低い人は、**与えられたタスクのパフォーマンスは高い**ものの、**自発的なイニシアティブは低い**ことが示されています。これは必ずしも問題ではなく、組織には「実行者」と「発案者」の両方が必要であり、あなたは前者として価値を提供しています。

また、このタイプは**不安症やうつ病のリスクが低い**傾向があります（低い達成動機 = 低いストレス）。ワークライフバランスが良好で、メンタルヘルスが安定しやすいという利点があります。

### 実用的アドバイス

**強みを活かす**
1. **スペシャリストの道**: 広く浅くより、狭く深く。特定分野の専門家として着実にキャリアを築く
2. **オペレーション業務**: プロジェクト管理、品質管理、事務職など、確実性が求められる役割で力を発揮
3. **長期的信頼の構築**: 派手さはなくても、長く安定した成果で評価を積み上げる

**成長の余地を探る**
1. **小さな挑戦**: 大きなリスクは不要。月に1回、「いつもと違うこと」を試してみる
2. **目標設定の練習**: 「今年中にこれを達成したい」という目標を1つだけ設定してみる
3. **メンターの活用**: 達成動機の高い人をメンターにし、視野を広げる

**キャリアの注意点**
1. **受け身になりすぎない**: 「言われたことだけやる」だけでは、キャリアの選択肢が狭まります
2. **評価の可視化**: 自分の貢献を記録し、適切にアピールする。実績が埋もれないように
3. **変化への対応**: 組織再編や業務変更に柔軟に対応する練習

**このままでも良い選択肢**
- 無理に野心的になる必要はありません
- 安定したキャリア、ワークライフバランス、メンタルヘルスの良好さは大きな価値
- 自分のペースを尊重しながら、必要な時だけ一歩踏み出せば十分

**自己受容**
- 「もっと頑張らなきゃ」というプレッシャーに振り回されない
- あなたの着実さは、組織や社会にとって不可欠な資質
- 「普通であることの強さ」を認識する`;

    case "relaxed":
      return `## マイペース型（達成動機: 低、自己鍛錬: 低）

### あなたの特徴

あなたは**マイペース型**です（達成動機: ${c4_label}、自己鍛錬: ${c5_label}）。

高い目標を追求することにも、厳格なスケジュールに従うことにも、あまり関心がありません。柔軟で自由な生き方を好み、ストレスの少ない環境を選びます。「成功」よりも「心地よさ」を重視し、自分のペースを大切にします。周囲からは「のんびりしている」「マイペース」と見られることが多いでしょう。現代社会の「もっと頑張れ」というプレッシャーとは距離を置いた、独自の価値観を持っています。

### 日常生活への影響

**仕事・学業**
締め切りを守ることや、高い成果を出すことに苦労しやすい傾向があります。タスクを先延ばしにしがちで、直前になって慌てることが多いでしょう。上司や教師から「もっと頑張って」「計画的に」と言われることが頻繁にあるかもしれません。キャリアアップや昇進への関心が低く、「最低限の仕事をして生活できればいい」という考え方を持ちやすいです。

ただし、**創造性や柔軟性**という面では強みがあります。ルールに縛られない発想ができ、予想外のアイデアを出すことがあります。また、ストレスが少ないため、長期的には燃え尽きにくいという利点もあります。

**対人関係**
おおらかで他人に厳しくなく、一緒にいてリラックスできる存在です。競争心が低いため、友人関係は良好です。ただし、「頼りない」「責任感がない」と見られることもあり、特に仕事上のパートナーシップでは信頼を得にくいことがあります。約束を忘れたり、時間に遅れることが多いと、人間関係にも影響します。

**意思決定**
「なんとなく」「流れに任せて」という決め方が多く、計画的な意思決定は苦手です。大きな決断を避け、現状維持を選びがちです。これは楽な反面、人生の重要な局面で機会を逃すリスクもあります。

**余暇・プライベート**
自由時間を楽しみ、趣味や娯楽に時間を使います。「何もしない時間」を心地よく感じられ、リラックスが得意です。ただし、長期的な目標（貯金、健康管理、スキルアップなど）が疎かになることがあります。

### 心理学的背景

誠実性が低いことは、必ずしも「悪い」わけではありません。研究では、誠実性が極端に高い人は**強迫性や柔軟性の欠如**のリスクがあり、低い人は**創造性や開放性**が高い傾向があることが示されています（DeYoung et al., 2007）。

進化心理学的には、集団の中には「慎重で計画的な個体」と「柔軟で適応的な個体」の両方が必要であり、どちらも生存戦略として有効です。現代社会は**誠実性を過度に重視する傾向**がありますが、歴史的にはさまざまな性格タイプが共存してきました。

ただし、現代の学校や職場では誠実性が高く評価されるため、このタイプは**制度的な不利益**を受けやすいことも事実です。ADHD（注意欠如・多動症）の可能性もあるため、日常生活に大きな支障がある場合は専門家への相談も検討してください。

### 実用的アドバイス

**現状で困っていない場合**
- 無理に変わる必要はありません
- 自分の価値観（成功<自由、地位<快適さ）を尊重する
- 社会の「成功」の定義に振り回されない
- ストレスが少ない生活は、それ自体が大きな価値

**改善が必要な場合（仕事や生活に支障がある）**
1. **最小限の構造を作る**
   - 毎日のルーティン（起床時間、食事時間）を1つだけ決める
   - スマホのリマインダーを活用
   - 「やらないと困ること」だけリストアップ

2. **外部サポートの活用**
   - 友人や家族に締め切りを管理してもらう
   - アプリ（Todoist, Habiticaなど）で自動リマインダー
   - 場合によってはコーチングやカウンセリング

3. **環境設計**
   - 誘惑を減らす（テレビのない部屋で作業、スマホを別室に）
   - デフォルトを「やる」にする（自動引き落とし、定期配送など）

**キャリア選択**
- **フリーランス・創造職**: 時間管理を自分でコントロールできる仕事
- **ルーティンが少ない仕事**: 毎日違うことをする仕事（イベント業、旅行業など）
- **趣味を仕事に**: 情熱がある分野なら自然と継続できる

**医療的支援の検討**
- 「頭ではわかっているのに行動できない」が慢性的に続く場合
- 日常生活に重大な支障（失職、人間関係の破綻）がある場合
- ADHD評価を専門医（精神科、心療内科）に相談
- 適切な診断と支援（薬物療法、認知行動療法）で大きく改善することも

**自己受容が最も重要**
- 「ダメな人間」ではなく、「異なるタイプの人間」
- 現代社会が特定の性格タイプ（高誠実性）を過度に評価しているだけ
- あなたの柔軟性、創造性、ストレス耐性の低さ（ポジティブな意味で）は、別の文脈では強みになる`;
  }
}

/**
 * パーセンタイルからラベルを取得
 */
function getPercentileLabel(percentile: number): string {
  if (percentile >= 75) return "高い";
  if (percentile >= 50) return "やや高い";
  if (percentile >= 25) return "やや低い";
  return "低い";
}

/**
 * 詳細解釈（構造化）
 * Rosenbergと同じ形式で4つのセクションに分割
 */
export function getDetailedInterpretation(
  quadrant: IndustriousnessQuadrant,
  c4_percentile: number,
  c5_percentile: number
): DetailedInterpretation {
  const c4_label = getPercentileLabel(c4_percentile);
  const c5_label = getPercentileLabel(c5_percentile);

  const interpretations: Record<IndustriousnessQuadrant, DetailedInterpretation> = {
    achiever: {
      summary: `## 実行者型（達成動機: 高、自己鍛錬: 高）

### あなたの特徴

あなたは**実行者型**です（達成動機: ${c4_label}、自己鍛錬: ${c5_label}）。

高い目標を設定し、それを着実に実行に移す力を兼ね備えています。野心と自己統制のバランスが取れており、長期的な目標に向かって計画的に努力を続けられます。学業や仕事において高いパフォーマンスを発揮しやすく、「言ったことを必ずやる人」として周囲から信頼されているでしょう。この特性は、誠実性（Conscientiousness）の中でも特に成功と強く結びついた組み合わせです。`,

      dailyLifeImpact: `**仕事・学業**
プロジェクトの遂行能力が非常に高く、締め切りを守りながら質の高い成果を出せます。目標設定が明確で、そこに向かう具体的な行動計画を立てて実行できるため、上司や教師から高く評価されることが多いでしょう。昇進や成績上位者に選ばれやすく、リーダーシップを発揮する場面も多いはずです。ただし、過度な完璧主義や長時間労働に陥りやすく、燃え尽き症候群（バーンアウト）のリスクも抱えています。

**対人関係**
約束を守る信頼できる人として評価される一方で、他人にも同じ基準を求めてしまい、「厳しい」「融通が利かない」と感じられることがあります。特に達成動機の高さから、チームメンバーにも高いパフォーマンスを期待し、それが達成されないとストレスを感じやすいでしょう。意識的にリラックスした交流を持つことが、人間関係の質を高めます。

**意思決定**
合理的で計画的な意思決定ができます。目標達成に必要な選択肢を冷静に評価し、実行可能性の高い道を選びます。ただし、完璧を求めすぎて決断が遅れたり、「今すぐやる」ことに固執して柔軟性を失うこともあるため、状況に応じた調整が必要です。

**余暇・プライベート**
趣味やプライベートでも目標を設定しがちで、「リラックスする」ことが苦手な傾向があります。休暇中も何かを達成しようとしてしまい、本当の休息が取れないことがあります。意識的に「何も生産しない時間」を作ることが、長期的なパフォーマンス維持に重要です。`,

      psychBackground: `研究によると、達成動機と自己鍛錬の両方が高い人は、学業成績（GPA）、職業的成功、収入の高さと強く相関します（Roberts et al., 2005）。この組み合わせは、誠実性（Conscientiousness）の中核的要素であり、Big Fiveの中で**最も仕事のパフォーマンスを予測する特性**として知られています（メタ分析: r = 0.22-0.31）。

神経科学的には、前頭前皮質の活動と関連しており、目標志向的な行動制御、衝動の抑制、長期的報酬の優先が可能になります。遺伝的要因も大きく（遺伝率 約40-50%）、幼少期からの安定した特性として現れます。

ただし、過度に高い場合は**ワーカホリズム**（仕事依存症）や強迫的な完璧主義と重なることがあり、メンタルヘルスのリスクも認識する必要があります。`,

      practicalAdvice: `**強みを活かす**
1. **長期プロジェクトのリード**: あなたの計画性と実行力を活かし、数ヶ月〜数年単位のプロジェクトで中心的役割を担いましょう
2. **目標管理システムの構築**: 自分の強みを体系化し、GTD（Getting Things Done）やOKR（Objectives and Key Results）などのフレームワークを導入すると、さらに効率が上がります
3. **メンターシップ**: 後輩や同僚に目標達成の方法を教えることで、組織全体のパフォーマンスが向上します

**バランスを取る（重要）**
1. **意図的な休息**: 週に1日は「何も達成しない日」を作る。スケジュールに「リラックス時間」を明示的に組み込む
2. **完璧主義の緩和**: 「80%の完成度で十分」という基準を持つ。全てを100%にする必要はありません
3. **柔軟性の訓練**: 計画通りにいかないことを受け入れる練習。予定外の出来事を楽しむ余裕を持つ

**注意すべきリスク**
1. **バーンアウト**: 高い基準を維持し続けると燃え尽きます。疲労のサインを見逃さない
2. **対人関係の摩擦**: 他人に同じ基準を求めない。多様な働き方を尊重する
3. **ワークライフバランス**: 仕事の成功が人生の全てではありません。家族、友人、健康への投資も重要です

**自己モニタリング**
- 週に1回、「今週は楽しめたか？」を自問する
- 睡眠時間が6時間を下回る週が続いたら危険信号
- 「休むことへの罪悪感」が強い場合は、カウンセリングも検討`,
    },

    visionary: {
      summary: `## 構想家型（達成動機: 高、自己鍛錬: 低）

### あなたの特徴

あなたは**構想家型**です（達成動機: ${c4_label}、自己鍛錬: ${c5_label}）。

大きな目標やビジョンを持ち、野心的な計画を立てることが得意です。しかし、それを具体的な行動に移したり、日々のタスクを着実にこなすことには課題を感じやすい傾向があります。「思い立ったらすぐ行動」するタイプではありますが、継続的な努力が必要な局面では先延ばしにしがちです。潜在能力は高いものの、実行段階で苦労することが多いでしょう。`,

      dailyLifeImpact: `**仕事・学業**
新しいプロジェクトのアイデア出しや戦略立案は得意ですが、細かいタスクの実行や締め切り管理に苦労します。「やりたいこと」はたくさんあるのに、実際に完成させるプロジェクトは少ないかもしれません。スタートダッシュは良いものの、中盤で失速したり、締め切り直前に慌てて仕上げるパターンが多いでしょう。上司からは「もっと計画的に」「もっと地道に」と言われることがあるかもしれません。

**対人関係**
理想や目標について熱く語ることができ、周囲を鼓舞する力があります。しかし、約束を守れなかったり、「言うだけで行動が伴わない」と見られることがあり、信頼を損なうリスクがあります。特にチームワークが求められる場面で、自分のタスクを完了させられないと、他メンバーに迷惑をかけてしまいます。

**意思決定**
大きな方向性の決定は得意ですが、具体的な実行計画や細部の詰めが甘くなりがちです。「こうなったらいいな」という理想は描けても、「どうやって実現するか」の具体策が不足します。また、衝動的な決断をしてしまい、後から「やっぱり無理だった」となることもあります。

**余暇・プライベート**
多趣味で興味の幅が広く、新しいことに挑戦するのが好きです。ただし、どれも中途半端で終わってしまい、「続かない人」という自己評価を持ちがちです。ジムに入会しても続かない、資格勉強を始めても途中で挫折する、といったパターンが繰り返されることがあります。`,

      psychBackground: `この組み合わせは、**達成動機は高いが実行機能（Executive Function）が弱い**状態を示しています。前頭前皮質の目標設定回路は活発ですが、行動開始や持続を司る部分の機能が相対的に低い可能性があります。

研究では、達成動機だけが高く自己鍛錬が低い場合、目標達成率は平均的かそれ以下になることが示されています（Duckworth et al., 2007）。**「やる気はあるのに行動できない」**というギャップは、ADHD（注意欠如・多動症）の傾向とも関連することがあります（ただし診断ではありません）。

興味深いことに、このタイプは**起業家やクリエイター**に多く見られ、アイデアの豊富さや柔軟性という強みも持っています。ただし、持続的成功のためには、実行をサポートする仕組みやパートナーが必要です。`,

      practicalAdvice: `**実行力を補う仕組み作り**
1. **外部構造の活用**: 締め切りを他人に宣言する、アカウンタビリティ・パートナーを持つ、コーチングを受けるなど、外部からのプレッシャーを活用
2. **タスク分解**: 大きな目標を「今日できる15分のタスク」まで分解する。小さな一歩から始める
3. **環境設計**: 誘惑を排除し、作業環境を整える。スマホを別室に置く、作業専用スペースを作るなど

**強みを活かす場面**
1. **アイデア出しの役割**: ブレインストーミング、戦略立案、ビジョン策定など、構想段階で力を発揮
2. **パートナーシップ**: 実行力の高い人とチームを組む。あなたが「何を」を決め、相手が「どうやって」を担当
3. **短期集中型の仕事**: 長期プロジェクトより、短期で完結するタスクの方が成功しやすい

**自己鍛錬の育成（段階的に）**
1. **習慣化アプローチ**: 「毎日5分」など、極めて小さな習慣から始める（Tiny Habits / BJ Fogg）
2. **if-thenプランニング**: 「もし〇〇したら、すぐに△△する」という具体的なトリガーを設定
3. **進捗の可視化**: チェックリスト、進捗バー、カレンダーなどで「やった感」を視覚化

**専門家の支援も検討**
- 慢性的に「やりたいのにできない」が続く場合、ADHD評価を専門医に相談するのも一案
- コーチングやカウンセリングで、行動変容の支援を受ける
- 「自分はダメ」と責めず、「仕組みで解決できる」という視点を持つ`,
    },
    steady: {
      summary: `## 着実型（達成動機: 低、自己鍛錬: 高）

### あなたの特徴

あなたは**着実型**です（達成動機: ${c4_label}、自己鍛錬: ${c5_label}）。

高い目標を掲げることよりも、日々の仕事を確実にこなすことを重視します。計画的で規律正しく、与えられたタスクを着実に完了させる力があります。野心的なキャリアアップよりも、安定した生活や着実な成長を好む傾向があります。「地に足がついている」「信頼できる」と評価されることが多く、組織の縁の下の力持ちとして重要な役割を果たしています。`,

      dailyLifeImpact: `**仕事・学業**
ルーチンワークや決められたタスクの遂行能力が高く、ミスが少なく期限を守ります。上司から指示されたことは確実にこなし、「安心して任せられる人」として信頼されます。ただし、自ら新しいプロジェクトを立ち上げたり、昇進のために積極的にアピールしたりすることは少ないでしょう。現状維持を好み、リスクを取った挑戦には消極的です。そのため、能力があってもキャリアの伸びが緩やかになることがあります。

**対人関係**
穏やかで協調的、チームの安定性に貢献します。派手さはありませんが、地道に人間関係を築き、長期的な信頼を得られます。他人に高い要求をせず、それぞれのペースを尊重するため、一緒にいて楽な存在です。ただし、リーダーシップを発揮する場面では物足りなさを感じられることもあります。

**意思決定**
リスクを避け、安全で確実な選択肢を選びます。「現状を維持する」という選択が多く、大きな変化を避ける傾向があります。これは安定性をもたらしますが、新しいチャンスを逃したり、変化が必要な時に対応が遅れることもあります。

**余暇・プライベート**
ルーティンを好み、規則正しい生活を送ります。毎週同じ曜日に同じことをする、といった習慣を持ちやすく、それが安心感につながります。新しい趣味や旅行よりも、慣れ親しんだ活動を楽しむ傾向があります。`,

      psychBackground: `このタイプは、**実行機能は高いが動機づけシステムが控えめ**という特徴があります。神経科学的には、前頭前皮質の行動制御は機能していますが、報酬系（腹側線条体、側坐核）の活動が比較的低い可能性があります。

研究では、自己鍛錬が高いが達成動機が低い人は、**与えられたタスクのパフォーマンスは高い**ものの、**自発的なイニシアティブは低い**ことが示されています。これは必ずしも問題ではなく、組織には「実行者」と「発案者」の両方が必要であり、あなたは前者として価値を提供しています。

また、このタイプは**不安症やうつ病のリスクが低い**傾向があります（低い達成動機 = 低いストレス）。ワークライフバランスが良好で、メンタルヘルスが安定しやすいという利点があります。`,

      practicalAdvice: `**強みを活かす**
1. **スペシャリストの道**: 広く浅くより、狭く深く。特定分野の専門家として着実にキャリアを築く
2. **オペレーション業務**: プロジェクト管理、品質管理、事務職など、確実性が求められる役割で力を発揮
3. **長期的信頼の構築**: 派手さはなくても、長く安定した成果で評価を積み上げる

**成長の余地を探る**
1. **小さな挑戦**: 大きなリスクは不要。月に1回、「いつもと違うこと」を試してみる
2. **目標設定の練習**: 「今年中にこれを達成したい」という目標を1つだけ設定してみる
3. **メンターの活用**: 達成動機の高い人をメンターにし、視野を広げる

**キャリアの注意点**
1. **受け身になりすぎない**: 「言われたことだけやる」だけでは、キャリアの選択肢が狭まります
2. **評価の可視化**: 自分の貢献を記録し、適切にアピールする。実績が埋もれないように
3. **変化への対応**: 組織再編や業務変更に柔軟に対応する練習

**このままでも良い選択肢**
- 無理に野心的になる必要はありません
- 安定したキャリア、ワークライフバランス、メンタルヘルスの良好さは大きな価値
- 自分のペースを尊重しながら、必要な時だけ一歩踏み出せば十分

**自己受容**
- 「もっと頑張らなきゃ」というプレッシャーに振り回されない
- あなたの着実さは、組織や社会にとって不可欠な資質
- 「普通であることの強さ」を認識する`,
    },
    relaxed: {
      summary: `## マイペース型（達成動機: 低、自己鍛錬: 低）

### あなたの特徴

あなたは**マイペース型**です（達成動機: ${c4_label}、自己鍛錬: ${c5_label}）。

高い目標を追求することにも、厳格なスケジュールに従うことにも、あまり関心がありません。柔軟で自由な生き方を好み、ストレスの少ない環境を選びます。「成功」よりも「心地よさ」を重視し、自分のペースを大切にします。周囲からは「のんびりしている」「マイペース」と見られることが多いでしょう。現代社会の「もっと頑張れ」というプレッシャーとは距離を置いた、独自の価値観を持っています。`,

      dailyLifeImpact: `**仕事・学業**
締め切りを守ることや、高い成果を出すことに苦労しやすい傾向があります。タスクを先延ばしにしがちで、直前になって慌てることが多いでしょう。上司や教師から「もっと頑張って」「計画的に」と言われることが頻繁にあるかもしれません。キャリアアップや昇進への関心が低く、「最低限の仕事をして生活できればいい」という考え方を持ちやすいです。

ただし、**創造性や柔軟性**という面では強みがあります。ルールに縛られない発想ができ、予想外のアイデアを出すことがあります。また、ストレスが少ないため、長期的には燃え尽きにくいという利点もあります。

**対人関係**
おおらかで他人に厳しくなく、一緒にいてリラックスできる存在です。競争心が低いため、友人関係は良好です。ただし、「頼りない」「責任感がない」と見られることもあり、特に仕事上のパートナーシップでは信頼を得にくいことがあります。約束を忘れたり、時間に遅れることが多いと、人間関係にも影響します。

**意思決定**
「なんとなく」「流れに任せて」という決め方が多く、計画的な意思決定は苦手です。大きな決断を避け、現状維持を選びがちです。これは楽な反面、人生の重要な局面で機会を逃すリスクもあります。

**余暇・プライベート**
自由時間を楽しみ、趣味や娯楽に時間を使います。「何もしない時間」を心地よく感じられ、リラックスが得意です。ただし、長期的な目標（貯金、健康管理、スキルアップなど）が疎かになることがあります。`,

      psychBackground: `誠実性が低いことは、必ずしも「悪い」わけではありません。研究では、誠実性が極端に高い人は**強迫性や柔軟性の欠如**のリスクがあり、低い人は**創造性や開放性**が高い傾向があることが示されています（DeYoung et al., 2007）。

進化心理学的には、集団の中には「慎重で計画的な個体」と「柔軟で適応的な個体」の両方が必要であり、どちらも生存戦略として有効です。現代社会は**誠実性を過度に重視する傾向**がありますが、歴史的にはさまざまな性格タイプが共存してきました。

ただし、現代の学校や職場では誠実性が高く評価されるため、このタイプは**制度的な不利益**を受けやすいことも事実です。ADHD（注意欠如・多動症）の可能性もあるため、日常生活に大きな支障がある場合は専門家への相談も検討してください。`,

      practicalAdvice: `**現状で困っていない場合**
- 無理に変わる必要はありません
- 自分の価値観（成功<自由、地位<快適さ）を尊重する
- 社会の「成功」の定義に振り回されない
- ストレスが少ない生活は、それ自体が大きな価値

**改善が必要な場合（仕事や生活に支障がある）**
1. **最小限の構造を作る**
   - 毎日のルーティン（起床時間、食事時間）を1つだけ決める
   - スマホのリマインダーを活用
   - 「やらないと困ること」だけリストアップ

2. **外部サポートの活用**
   - 友人や家族に締め切りを管理してもらう
   - アプリ（Todoist, Habiticaなど）で自動リマインダー
   - 場合によってはコーチングやカウンセリング

3. **環境設計**
   - 誘惑を減らす（テレビのない部屋で作業、スマホを別室に）
   - デフォルトを「やる」にする（自動引き落とし、定期配送など）

**キャリア選択**
- **フリーランス・創造職**: 時間管理を自分でコントロールできる仕事
- **ルーティンが少ない仕事**: 毎日違うことをする仕事（イベント業、旅行業など）
- **趣味を仕事に**: 情熱がある分野なら自然と継続できる

**医療的支援の検討**
- 「頭ではわかっているのに行動できない」が慢性的に続く場合
- 日常生活に重大な支障（失職、人間関係の破綻）がある場合
- ADHD評価を専門医（精神科、心療内科）に相談
- 適切な診断と支援（薬物療法、認知行動療法）で大きく改善することも

**自己受容が最も重要**
- 「ダメな人間」ではなく、「異なるタイプの人間」
- 現代社会が特定の性格タイプ（高誠実性）を過度に評価しているだけ
- あなたの柔軟性、創造性、ストレス耐性の低さ（ポジティブな意味で）は、別の文脈では強みになる`,
    },
  };

  return interpretations[quadrant];
}

// ============================================================================
// Test Configuration
// ============================================================================

/**
 * Industriousness (勤勉性) テスト設定
 */
export const industriousnessConfig: TestConfig<IndustriousnessResult> = {
  id: "industriousness",
  color: "green",
  basePath: "/industriousness",
  questions: industriousnessQuestions,
  scaleOptions,
  calculateScore: calculateIndustriousnessScore,
  scaleInfo,

  // 結果ページ設定
  resultExtensions: {
    shareButtons: true,
  },

  // OG画像設定
  ogImage: {
    layoutType: "bar",
    titleEn: "INDUSTRI-\nOUSNESS",
    category: "勤勉性診断",
    description: "やり抜く力を測定\n2つの次元で評価",
    scoreToParams: (result: IndustriousnessResult) => ({
      c4: (result?.c4_achievement ?? 30).toString(),
      c5: (result?.c5_discipline ?? 30).toString(),
    }),
    paramsToScore: (params: URLSearchParams) => ({
      c4: parseInt(params.get("c4") || "30"),
      c5: parseInt(params.get("c5") || "30"),
    }),
  },

  // 🆕 NEW: 2次元データ生成
  getDimensions: (result: IndustriousnessResult): DimensionData[] => {
    const c4 = result?.c4_achievement ?? 30;
    const c5 = result?.c5_discipline ?? 30;

    return [
      {
        key: 'c4',
        label: '達成動機',
        score: c4,
        percentage: ((c4 - 10) / 40) * 100,
        color: INDUSTRIOUSNESS_COLORS.c4,
      },
      {
        key: 'c5',
        label: '自己統制',
        score: c5,
        percentage: ((c5 - 10) / 40) * 100,
        color: INDUSTRIOUSNESS_COLORS.c5,
      },
    ];
  },
};
