# OGç”»åƒ & SNSã‚·ã‚§ã‚¢å®Ÿè£…ã‚¬ã‚¤ãƒ‰

## æ¦‚è¦

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ã€è¨ºæ–­çµæœã‚’SNSã§ã‚·ã‚§ã‚¢ã™ã‚‹æ©Ÿèƒ½ã‚’**OGç”»åƒã‚¢ãƒ—ãƒ­ãƒ¼ãƒ**ã§å®Ÿè£…ã—ã¦ã„ã¾ã™ã€‚

### ãªãœOGç”»åƒã‚¢ãƒ—ãƒ­ãƒ¼ãƒãªã®ã‹ï¼Ÿ

ç”»åƒã®ã¿ã®ã‚·ã‚§ã‚¢ï¼ˆhtml2canvasç­‰ï¼‰ã¯è¦–è¦šçš„ã«ã¯ã‚¤ãƒ³ãƒ‘ã‚¯ãƒˆãŒã‚ã‚Šã¾ã™ãŒã€**ã‚µã‚¤ãƒˆã¸ã®ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚’ç”Ÿã¿ã¾ã›ã‚“**ã€‚

- âŒ ç”»åƒã‚·ã‚§ã‚¢ï¼šç”»åƒãŒè¡¨ç¤ºã•ã‚Œã‚‹ãŒã€ãƒªãƒ³ã‚¯ãªã— â†’ ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚¼ãƒ­
- âœ… OGç”»åƒä»˜ããƒªãƒ³ã‚¯ã‚·ã‚§ã‚¢ï¼šOGç”»åƒãŒSNSã«è¡¨ç¤º + ãƒªãƒ³ã‚¯ã‚ã‚Š â†’ ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ç²å¾—

ãƒãƒã‚¿ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆGoogle AdSenseã€ã‚¢ãƒ•ã‚£ãƒªã‚¨ã‚¤ãƒˆï¼‰ã«ã¯**ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ãŒä¸å¯æ¬ **ã§ã™ã€‚ãã®ãŸã‚ã€OGç”»åƒã®ã¿ã«çµã‚Šã€ç”»åƒã‚·ã‚§ã‚¢æ©Ÿèƒ½ã¯å®Ÿè£…ã—ã¦ã„ã¾ã›ã‚“ã€‚

### ãƒ‡ã‚¶ã‚¤ãƒ³çµ±ä¸€ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

**é‡è¦**: OGç”»åƒã¨çµæœãƒšãƒ¼ã‚¸ã®ã‚µãƒãƒªãƒ¼ã‚«ãƒ¼ãƒ‰ã¯**å®Œå…¨ã«åŒã˜ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«**ã§ã™ã€‚

```
lib/og-design/constants.ts  â† ğŸ¨ å…±é€šãƒ‡ã‚¶ã‚¤ãƒ³å®šæ•°
  â”œâ”€â”€ OG_SIZE (1200Ã—630px)
  â”œâ”€â”€ OG_COLORS (ã‚«ãƒ©ãƒ¼ãƒ‘ãƒ¬ãƒƒãƒˆ)
  â”œâ”€â”€ OG_LAYOUT (ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆå®šæ•°)
  â”œâ”€â”€ OG_TYPOGRAPHY (ã‚¿ã‚¤ãƒã‚°ãƒ©ãƒ•ã‚£)
  â””â”€â”€ DIMENSION_NAMES (æ¬¡å…ƒå)
      â†“
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â†“                   â†“                   â†“
components/results/   functions/og/       app/results/
ResultSummaryCard     [test].tsx          bigfive/page.tsx
(Reactã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ) (Satori/OGç”»åƒ)     (çµæœãƒšãƒ¼ã‚¸)
```

**ãƒ¡ãƒªãƒƒãƒˆ**:
- ãƒ‡ã‚¶ã‚¤ãƒ³å¤‰æ›´ãŒä¸€ç®‡æ‰€ã§å®Œçµï¼ˆconstants.tsã®ã¿ï¼‰
- OGç”»åƒã¨çµæœãƒšãƒ¼ã‚¸ã®ä¸€è²«æ€§ä¿è¨¼
- TypeScriptã®å‹å®‰å…¨æ€§

## ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### ãƒªãƒ³ã‚¯ã§ã‚·ã‚§ã‚¢ï¼ˆOGç”»åƒï¼‰

```
ã€çµæœãƒšãƒ¼ã‚¸ã€‘(SSG - app/results/bigfive/page.tsx)
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ResultSummaryCard (1200Ã—630px)              â”‚
â”‚  - OGç”»åƒã¨å®Œå…¨ã«åŒã˜ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«             â”‚
â”‚  - å…±é€šå®šæ•°ï¼ˆconstants.tsï¼‰ã‚’ä½¿ç”¨           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
<SocialShareButtons> ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
  â†“
/share/bigfive?e=75&... ã®URLã‚’ç”Ÿæˆ
  â†“
SNSã‚·ã‚§ã‚¢ãƒ€ã‚¤ã‚¢ãƒ­ã‚° (Twitter/Facebook/LINE)
  â†“
SNSã‚¯ãƒ­ãƒ¼ãƒ©ãƒ¼ãŒã‚·ã‚§ã‚¢ãƒšãƒ¼ã‚¸ã«ã‚¢ã‚¯ã‚»ã‚¹
  â†“
/share/bigfive (Cloudflare Pages Function)
  â†’ OGç”»åƒãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’å«ã‚€HTMLã‚’è¿”ã™
  â†“
/og/bigfive?e=75&... (Cloudflare Pages Function)
  â†’ Satoriã§å‹•çš„ã«OGç”»åƒç”Ÿæˆ (1200x630px PNG)
  â†’ å…±é€šå®šæ•°ï¼ˆconstants.tsï¼‰ã‚’ä½¿ç”¨
```

## å®Ÿè£…è©³ç´°

### 0. å…±é€šãƒ‡ã‚¶ã‚¤ãƒ³å®šæ•°ï¼ˆDesign Systemï¼‰

**ãƒ•ã‚¡ã‚¤ãƒ«**: `lib/og-design/constants.ts`, `lib/og-design/types.ts`

OGç”»åƒã¨ResultSummaryCardã§å…±æœ‰ã™ã‚‹ãƒ‡ã‚¶ã‚¤ãƒ³å®šæ•°ã¨å‹å®šç¾©ã§ã™ã€‚

**constants.ts**:
- `OG_SIZE`: ç”»åƒã‚µã‚¤ã‚ºï¼ˆ1200Ã—630pxï¼‰
- `OG_COLORS`: ã‚«ãƒ©ãƒ¼ãƒ‘ãƒ¬ãƒƒãƒˆï¼ˆNeo-Brutalistï¼‰
- `OG_LAYOUT`: ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆå®šæ•°ï¼ˆpadding, widthç­‰ï¼‰
- `OG_TYPOGRAPHY`: ã‚¿ã‚¤ãƒã‚°ãƒ©ãƒ•ã‚£ï¼ˆfontSize, fontWeightç­‰ï¼‰
- `DIMENSION_NAMES`: Big Fiveæ¬¡å…ƒåï¼ˆæ—¥æœ¬èªï¼‰
- `DIMENSION_ORDER`: è¡¨ç¤ºé †åº

**types.ts**:
- `DimensionKey`: æ¬¡å…ƒã‚­ãƒ¼ã®å‹
- `DimensionData`: æ¬¡å…ƒãƒ‡ãƒ¼ã‚¿ã®å‹
- `ResultSummaryProps`: ã‚µãƒãƒªãƒ¼ã‚«ãƒ¼ãƒ‰ã®Propså‹

### 1. ResultSummaryCard ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

**ãƒ•ã‚¡ã‚¤ãƒ«**: `components/results/ResultSummaryCard.tsx`

çµæœãƒšãƒ¼ã‚¸ã®æœ€åˆã«è¡¨ç¤ºã•ã‚Œã‚‹1200Ã—630pxã®ã‚µãƒãƒªãƒ¼ã‚«ãƒ¼ãƒ‰ã§ã™ã€‚OGç”»åƒã¨**å®Œå…¨ã«åŒã˜ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«**ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

**ä¸»ãªæ©Ÿèƒ½**:
- OGç”»åƒã¨åŒã˜ãƒ‡ã‚¶ã‚¤ãƒ³å®šæ•°ã‚’ä½¿ç”¨
- 1200Ã—630pxã®ã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯”ã‚’ç¶­æŒï¼ˆãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ï¼‰
- Big Five 5æ¬¡å…ƒã®ã‚¹ã‚³ã‚¢ãƒãƒ¼ã‚’è¡¨ç¤º

**ä½¿ã„æ–¹**:
```tsx
import { ResultSummaryCard } from "@/components/results/ResultSummaryCard";
import { OG_COLORS, DIMENSION_NAMES, DIMENSION_ORDER } from "@/lib/og-design/constants";

const dimensionsForSummary: DimensionData[] = DIMENSION_ORDER.map((key) => ({
  key,
  label: DIMENSION_NAMES[key],
  score: bigFiveResult[key],
  percentage: toPercentage(bigFiveResult[key]),
  color: OG_COLORS.dimensions[key],
}));

<ResultSummaryCard
  dimensions={dimensionsForSummary}
  testName="Big Five æ€§æ ¼è¨ºæ–­çµæœ"
  siteName="å¿ƒç†æ¸¬å®šãƒ©ãƒœ"
/>
```

### 2. SocialShareButtons ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

**ãƒ•ã‚¡ã‚¤ãƒ«**: `components/share/SocialShareButtons.tsx`

Twitter/Facebook/LINEã®ã‚·ã‚§ã‚¢ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’é–‹ããƒœã‚¿ãƒ³ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ã™ã€‚

**ä¸»ãªæ©Ÿèƒ½**:
- ã‚·ã‚§ã‚¢ãƒšãƒ¼ã‚¸URLã‚’ç”Ÿæˆ
- å„SNSã®ã‚·ã‚§ã‚¢URLã‚¹ã‚­ãƒ¼ãƒ ã§æ–°è¦ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’é–‹ã
- OGç”»åƒã¯SNSã‚¯ãƒ­ãƒ¼ãƒ©ãƒ¼ãŒè‡ªå‹•å–å¾—

**ä½¿ã„æ–¹**:
```tsx
<SocialShareButtons
  shareUrl={`https://psychtest.jp/share/bigfive?e=${e}&a=${a}&c=${c}&n=${n}&o=${o}`}
  text="Big Fiveæ€§æ ¼è¨ºæ–­ã®çµæœã‚’ã‚·ã‚§ã‚¢ï¼"
/>
```

### 3. Cloudflare Pages Function (OGç”»åƒç”Ÿæˆã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ)

**ãƒ•ã‚¡ã‚¤ãƒ«**: `functions/og/[test].tsx`

- `@cloudflare/pages-plugin-vercel-og`ã‚’ä½¿ç”¨
- Satoriãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ React/JSXã‚’ç”»åƒã«å¤‰æ›
- **å…±é€šå®šæ•°ï¼ˆconstants.tsï¼‰ã‚’ä½¿ç”¨**ã—ã¦ResultSummaryCardã¨å®Œå…¨ã«åŒã˜ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ã‚’ç”Ÿæˆ
- ãƒ†ã‚¹ãƒˆã”ã¨ã«ç•°ãªã‚‹ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ã‚’ç”Ÿæˆå¯èƒ½

**ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆä¾‹**:
```
/og/bigfive?e=75&a=85&c=60&n=45&o=90
```

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿** (Big Five):
- `e`: å¤–å‘æ€§ã‚¹ã‚³ã‚¢ (24-120)
- `a`: å”èª¿æ€§ã‚¹ã‚³ã‚¢ (24-120)
- `c`: èª å®Ÿæ€§ã‚¹ã‚³ã‚¢ (24-120)
- `n`: ç¥çµŒç—‡å‚¾å‘ã‚¹ã‚³ã‚¢ (24-120)
- `o`: é–‹æ”¾æ€§ã‚¹ã‚³ã‚¢ (24-120)

### 4. ã‚·ã‚§ã‚¢å°‚ç”¨ãƒšãƒ¼ã‚¸ (ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ)

**ãƒ•ã‚¡ã‚¤ãƒ«**: `functions/share/bigfive.tsx` (Cloudflare Pages Function)

**é‡è¦**: Next.js `output: 'export'` ãƒ¢ãƒ¼ãƒ‰ã§ã¯å‹•çš„ãª`searchParams`ãŒä½¿ãˆãªã„ãŸã‚ã€Cloudflare Pages Functionã¨ã—ã¦å®Ÿè£…ã—ã¦ã„ã¾ã™ã€‚

- URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‹ã‚‰ã‚¹ã‚³ã‚¢ã‚’èª­ã¿å–ã‚Šã€OGç”»åƒURLã‚’å‹•çš„ç”Ÿæˆ
- SNSã‚¯ãƒ­ãƒ¼ãƒ©ãƒ¼ç”¨ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’è¨­å®šã—ãŸHTMLã‚’è¿”ã™
- å®Ÿéš›ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã¯çµæœã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’è¡¨ç¤º

**URLä¾‹**:
```
https://psychtest.jp/share/bigfive?e=75&a=85&c=60&n=45&o=90
```

### 5. å‹å®šç¾©

**ãƒ•ã‚¡ã‚¤ãƒ«**: `functions/types.d.ts`

- Cloudflare Pages Functionsç”¨ã®å‹å®šç¾©
- `PagesFunction`å‹ã¨EventContextå‹
- `@cloudflare/workers-types`ã‚’å‚ç…§

## ä½¿ã„æ–¹

### ã‚·ã‚§ã‚¢URLã®ç”Ÿæˆ

çµæœãƒšãƒ¼ã‚¸ã§ã‚·ã‚§ã‚¢ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ãŸéš›ã«ã€ä»¥ä¸‹ã®ã‚ˆã†ãªURLã‚’ç”Ÿæˆã—ã¾ã™:

```typescript
// ä¾‹: Big Fiveçµæœãƒšãƒ¼ã‚¸å†…
const shareUrl = new URL(`${window.location.origin}/share/bigfive`);
shareUrl.searchParams.set('e', bigFiveResult.extraversion.toString());
shareUrl.searchParams.set('a', bigFiveResult.agreeableness.toString());
shareUrl.searchParams.set('c', bigFiveResult.conscientiousness.toString());
shareUrl.searchParams.set('n', bigFiveResult.neuroticism.toString());
shareUrl.searchParams.set('o', bigFiveResult.openness.toString());

// Twitter/X
const twitterUrl = `https://twitter.com/intent/tweet?url=${encodeURIComponent(shareUrl.toString())}&text=${encodeURIComponent('Big Fiveæ€§æ ¼è¨ºæ–­ã®çµæœï¼')}`;

// Facebook
const facebookUrl = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(shareUrl.toString())}`;
```

## ãƒ­ãƒ¼ã‚«ãƒ«ãƒ†ã‚¹ãƒˆ

### 1. ã‚·ã‚§ã‚¢ãƒšãƒ¼ã‚¸ã®ãƒ†ã‚¹ãƒˆ (Next.jsé–‹ç™ºã‚µãƒ¼ãƒãƒ¼)

```bash
npm run dev
```

ä»¥ä¸‹ã®URLã«ã‚¢ã‚¯ã‚»ã‚¹:
```
http://localhost:3000/share/bigfive?e=75&a=85&c=60&n=45&o=90
```

- ãƒšãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
- ãƒšãƒ¼ã‚¸ã‚½ãƒ¼ã‚¹ã‚’è¡¨ç¤ºã—ã¦`<meta property="og:image">`ã‚¿ã‚°ãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª

### 2. OGç”»åƒç”Ÿæˆã®ãƒ†ã‚¹ãƒˆ (Cloudflare Pages Functions)

**é‡è¦**: Cloudflare Pages Functionsã¯ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã§ã¯å‹•ä½œã—ã¾ã›ã‚“ã€‚

ãƒ†ã‚¹ãƒˆæ–¹æ³•ã®é¸æŠè‚¢:

#### A. Cloudflare Pagesã«ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¦ãƒ†ã‚¹ãƒˆ (æ¨å¥¨)

```bash
# ãƒ“ãƒ«ãƒ‰
npm run build

# Cloudflare Pagesã«ãƒ‡ãƒ—ãƒ­ã‚¤ (Cloudflare CLIã¾ãŸã¯ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰çµŒç”±)
npx wrangler pages deploy out/
```

ãƒ‡ãƒ—ãƒ­ã‚¤å¾Œã€ä»¥ä¸‹ã®URLã§ç”»åƒãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª:
```
https://your-project.pages.dev/og/bigfive?e=75&a=85&c=60&n=45&o=90
```

#### B. Wranglerã§ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç’°å¢ƒã‚’ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

```bash
# Wranglerã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm install -D wrangler

# ãƒ­ãƒ¼ã‚«ãƒ«ã§Pages Functionsã‚’å®Ÿè¡Œ
npx wrangler pages dev out/ --compatibility-flag=nodejs_compat
```

**æ³¨æ„**: é™çš„ãƒ•ã‚¡ã‚¤ãƒ«(`out/`)ãŒå¿…è¦ãªã®ã§ã€å…ˆã«`npm run build`ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚

### 3. SNSã‚·ã‚§ã‚¢ã®ãƒ†ã‚¹ãƒˆ

#### Facebookãƒ‡ãƒãƒƒã‚¬ãƒ¼
https://developers.facebook.com/tools/debug/

ã‚·ã‚§ã‚¢URLã‚’å…¥åŠ›ã—ã¦ã€OGç”»åƒãŒæ­£ã—ãè¡¨ç¤ºã•ã‚Œã‚‹ã‹ç¢ºèª

#### Twitterã‚«ãƒ¼ãƒ‰ãƒãƒªãƒ‡ãƒ¼ã‚¿ãƒ¼
https://cards-dev.twitter.com/validator

ã‚·ã‚§ã‚¢URLã‚’å…¥åŠ›ã—ã¦ã€Twitter CardãŒæ­£ã—ãè¡¨ç¤ºã•ã‚Œã‚‹ã‹ç¢ºèª

## ãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †

### Cloudflare Pagesã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤

1. **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ãƒ“ãƒ«ãƒ‰**
   ```bash
   npm run build
   ```

2. **Cloudflare Pagesã«ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ãƒ‡ãƒ—ãƒ­ã‚¤**

   #### æ–¹æ³•A: Cloudflare Dashboard (æ¨å¥¨)

   1. [Cloudflare Dashboard](https://dash.cloudflare.com/)ã«ãƒ­ã‚°ã‚¤ãƒ³
   2. "Pages" â†’ "Create a project" â†’ "Connect to Git"
   3. GitHubãƒªãƒã‚¸ãƒˆãƒªã‚’æ¥ç¶š
   4. ãƒ“ãƒ«ãƒ‰è¨­å®š:
      - **Build command**: `npm run build`
      - **Build output directory**: `out`
      - **Root directory**: `/`
   5. **Environment variables**: å¿…è¦ã«å¿œã˜ã¦è¨­å®š
   6. "Save and Deploy"

   #### æ–¹æ³•B: Wrangler CLI

   ```bash
   # åˆå›ã®ã¿: Cloudflareã«ãƒ­ã‚°ã‚¤ãƒ³
   npx wrangler login

   # ãƒ‡ãƒ—ãƒ­ã‚¤
   npx wrangler pages deploy out/ --project-name=psychtest-jp
   ```

3. **ãƒ‡ãƒ—ãƒ­ã‚¤å¾Œã®ç¢ºèª**

   - ã‚·ã‚§ã‚¢ãƒšãƒ¼ã‚¸ã«ã‚¢ã‚¯ã‚»ã‚¹: `https://psychtest.jp/share/bigfive?e=75&...`
   - OGç”»åƒã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã«ã‚¢ã‚¯ã‚»ã‚¹: `https://psychtest.jp/og/bigfive?e=75&...`
   - Facebook/Twitterã®ãƒ‡ãƒãƒƒã‚¬ãƒ¼ã§ãƒ†ã‚¹ãƒˆ

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### Q: OGç”»åƒãŒè¡¨ç¤ºã•ã‚Œãªã„

**A**: ä»¥ä¸‹ã‚’ç¢ºèªã—ã¦ãã ã•ã„:
1. Cloudflare Pagesã«`functions/`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚Œã¦ã„ã‚‹ã‹
2. ãƒ–ãƒ©ã‚¦ã‚¶ã§ç›´æ¥`/og/bigfive?e=75&...`ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ç”»åƒãŒè¡¨ç¤ºã•ã‚Œã‚‹ã‹
3. SNSã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ã‚¯ãƒªã‚¢ã™ã‚‹ï¼ˆFacebookãƒ‡ãƒãƒƒã‚¬ãƒ¼ã‚„Twitterãƒãƒªãƒ‡ãƒ¼ã‚¿ãƒ¼ã§"Scrape again"ï¼‰

### Q: TypeError: Cannot read property 'searchParams' of undefined

**A**: Cloudflare Pages Functionsã®`context.request`ãŒæ­£ã—ãæ¸¡ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„ã€‚

### Q: æ—¥æœ¬èªãƒ•ã‚©ãƒ³ãƒˆãŒè¡¨ç¤ºã•ã‚Œãªã„

**A**: Satoriã¯ä¸€éƒ¨ã®ãƒ•ã‚©ãƒ³ãƒˆã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã›ã‚“ã€‚ç¾åœ¨ã¯ã‚·ã‚¹ãƒ†ãƒ ãƒ•ã‚©ãƒ³ãƒˆï¼ˆsans-serifï¼‰ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ãŒã€ã‚«ã‚¹ã‚¿ãƒ ãƒ•ã‚©ãƒ³ãƒˆã‚’èª­ã¿è¾¼ã‚€å¿…è¦ãŒã‚ã‚‹å ´åˆã¯ã€æ¬¡ã®ã‚ˆã†ã«å®Ÿè£…ã—ã¾ã™:

```typescript
// functions/og/[test].tsx
import { ImageResponse } from '@cloudflare/pages-plugin-vercel-og/api';

export const onRequest: PagesFunction = async (context) => {
  // ãƒ•ã‚©ãƒ³ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’fetch
  const fontData = await fetch('https://fonts.googleapis.com/...').then(res => res.arrayBuffer());

  return new ImageResponse(
    <div>...</div>,
    {
      width: 1200,
      height: 630,
      fonts: [
        {
          name: 'Noto Sans JP',
          data: fontData,
          weight: 900,
        },
      ],
    }
  );
};
```

### Q: ãƒ­ãƒ¼ã‚«ãƒ«ã§FunctionsãŒå‹•ã‹ãªã„

**A**: Next.jsé–‹ç™ºã‚µãƒ¼ãƒãƒ¼ (`npm run dev`) ã§ã¯Cloudflare Pages Functionsã¯å‹•ä½œã—ã¾ã›ã‚“ã€‚`wrangler pages dev`ã‚’ä½¿ç”¨ã™ã‚‹ã‹ã€Cloudflare Pagesã«ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¦ãƒ†ã‚¹ãƒˆã—ã¦ãã ã•ã„ã€‚

## ä»Šå¾Œã®æ‹¡å¼µ

### ä»–ã®ãƒ†ã‚¹ãƒˆã¸ã®å¯¾å¿œ

ç¾åœ¨ã¯Big Fiveã®ã¿å®Ÿè£…ã•ã‚Œã¦ã„ã¾ã™ãŒã€ä»–ã®ãƒ†ã‚¹ãƒˆã‚‚åŒæ§˜ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã§å®Ÿè£…ã§ãã¾ã™:

1. `functions/og/[test].tsx`ã«æ–°ã—ã„ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°é–¢æ•°ã‚’è¿½åŠ 
   ```typescript
   if (test === 'industriousness') {
     return renderIndustriousnessOG(url);
   }
   ```

2. `app/share/[ãƒ†ã‚¹ãƒˆå]/page.tsx`ã‚’ä½œæˆ

3. çµæœãƒšãƒ¼ã‚¸ã«ã‚·ã‚§ã‚¢ãƒœã‚¿ãƒ³ã‚’è¿½åŠ 

### ãƒ‡ã‚¶ã‚¤ãƒ³ã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º

`functions/og/[test].tsx`ã®JSXéƒ¨åˆ†ã‚’ç·¨é›†ã™ã‚‹ã“ã¨ã§ã€ãƒ‡ã‚¶ã‚¤ãƒ³ã‚’è‡ªç”±ã«ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã§ãã¾ã™ã€‚

**ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³**:
- ã‚µã‚¤ã‚º: 1200Ã—630px
- ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚º: 100KBä»¥ä¸‹æ¨å¥¨
- é‡è¦ãªæƒ…å ±ã¯ä¸­å¤®ã«é…ç½®ï¼ˆSNSãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã«ã‚ˆã‚‹ã‚¯ãƒ­ãƒƒãƒ—å¯¾ç­–ï¼‰
- Neo-Brutalistã‚¹ã‚¿ã‚¤ãƒ«ã‚’ç¶­æŒ

## å‚è€ƒè³‡æ–™

- [Cloudflare Pages Functions](https://developers.cloudflare.com/pages/functions/)
- [Generate Dynamic OG Images (Cloudflareå…¬å¼ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«)](https://developers.cloudflare.com/workers/tutorials/generate-dynamic-og-images-using-workers/)
- [Vercel OG Plugin for Cloudflare](https://developers.cloudflare.com/pages/functions/plugins/vercel-og/)
- [Open Graph Protocol](https://ogp.me/)
- [Twitter Cards](https://developer.twitter.com/en/docs/twitter-for-websites/cards/overview/abouts-cards)
